Credit to esaj from electricunicycle.org for implementing a O(1) solution.
and to Chriull for also chiming in with great feedback related to the above solution.